var t,e={};const s=new((t=class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=JSON.parse(JSON.stringify(t)),this.board=JSON.parse(JSON.stringify(t)),this.score=0,this.status="idle"}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e of this.board){let s=e.filter(t=>0!==t),r=[],i=0;for(;i<s.length;)i<s.length-1&&s[i]===s[i+1]?(r.push(2*s[i]),this.score+=2*s[i],i+=2):(r.push(s[i]),i++);for(;r.length<e.length;)r.push(0);r.toString()!==e.toString()&&(t=!0),e.splice(0,e.length,...r)}t&&(this.addNumber(),this.checkGameOver())}moveRight(){if("playing"!==this.status)return;let t=!1;for(let e of this.board){let s=e.filter(t=>0!==t),r=[],i=0;for(;i<s.length;)i<s.length-1&&s[i]===s[i+1]?(r.push(2*s[i]),this.score+=2*s[i],i+=2):(r.push(s[i]),i++);for(;r.length<e.length;)r.unshift(0);r.toString()!==e.toString()&&(t=!0),e.splice(0,e.length,...r)}t&&(this.addNumber(),this.checkGameOver())}moveUp(){if("playing"!==this.status)return;let t=!1,e=[];for(let t=0;t<this.board[0].length;t++){let s=this.board.map(e=>e[t]);e.push(s)}for(let s of e){let e=s.filter(t=>0!==t),r=[],i=0;for(;i<e.length;)i<e.length-1&&e[i]===e[i+1]?(r.push(2*e[i]),this.score+=2*e[i],i+=2):(r.push(e[i]),i++);for(;r.length<s.length;)r.push(0);!t&&s.some((t,e)=>t!==r[e])&&(t=!0),s.splice(0,s.length,...r)}this.board=e[0].map((t,s)=>e.map(t=>t[s])),t&&(this.addNumber(),this.checkGameOver())}moveDown(){if("playing"!==this.status)return;let t=!1,e=[];for(let t=0;t<this.board[0].length;t++){let s=this.board.map(e=>e[t]);e.push(s)}for(let s of e){let e=s.filter(t=>0!==t),r=[],i=0;for(;i<e.length;)i<e.length-1&&e[i]===e[i+1]?(r.push(2*e[i]),this.score+=2*e[i],i+=2):(r.push(e[i]),i++);for(;r.length<s.length;)r.unshift(0);!t&&s.some((t,e)=>t!==r[e])&&(t=!0),s.splice(0,s.length,...r)}this.board=e[0].map((t,s)=>e.map(t=>t[s])),t&&(this.addNumber(),this.checkGameOver())}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.status="playing",this.addNumber(),this.addNumber()}addNumber(){let t=[];if(this.board.forEach((e,s)=>{e.forEach((e,r)=>{0===e&&t.push({row:s,col:r})})}),t.length>0){let e=t[Math.floor(Math.random()*t.length)],s=.9>Math.random()?2:4;this.board[e.row][e.col]=s}}restart(){this.board=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle"}checkGameOver(){if(this.board.some(t=>t.includes(2048))){this.status="win";return}if(this.board.some(t=>t.includes(0)))return!1;for(let t=0;t<4;t++)for(let e=0;e<4;e++){let s=this.board[t][e];if(t>0&&this.board[t-1][e]===s||t<3&&this.board[t+1][e]===s||e>0&&this.board[t][e-1]===s||e<3&&this.board[t][e+1]===s)return!1}return this.status="lose",!0}}).__esModule?t.default:t),r=document.querySelector(".game-field"),i=document.querySelector(".game-score"),a=document.querySelector(".button.start"),l=document.querySelector(".message-start"),o=document.querySelector(".message-win"),h=document.querySelector(".message-lose");function d(){let t=s.getState();r.querySelectorAll(".field-row").forEach((e,s)=>{e.querySelectorAll(".field-cell").forEach((e,r)=>{let i=t[s][r];e.textContent=0===i?"":i,e.className="field-cell",0!==i&&e.classList.add(`field-cell--${i}`)})}),i.textContent=s.getScore();let e=s.getStatus();"win"===e?(o.classList.remove("hidden"),h.classList.add("hidden")):"lose"===e?(h.classList.remove("hidden"),o.classList.add("hidden")):(o.classList.add("hidden"),h.classList.add("hidden"))}document.addEventListener("keydown",t=>{if("playing"===s.getStatus()){switch(t.key){case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight();break;case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown();break;default:return}d()}}),a.addEventListener("click",()=>{a.classList.contains("start")?(s.start(),d(),l.classList.add("hidden"),o.classList.add("hidden"),h.classList.add("hidden"),a.textContent="Restart",a.classList.remove("start"),a.classList.add("restart")):(s.restart(),d(),l.classList.remove("hidden"),o.classList.add("hidden"),h.classList.add("hidden"),a.textContent="Start",a.classList.remove("restart"),a.classList.add("start"))}),d();
//# sourceMappingURL=index.a815124f.js.map
